# 日本語
## このアプリについて
これはMusicManagerというWindowsOS専用のアプリです。v1.0.0-beta1ではポータブル版のみ対応しており、zipを展開してすぐに利用可能です。
アプリ内容についてですが、YouTubeなどのプラットフォームからダウンロードしたりしてご自身で入手された音楽を管理できるアプリとなっております。
おおよそオフラインでご利用いただけます。（一部オンラインが必要な機能搭載予定）
アプリ開発にはGemini 3 Pro Previewを利用しております。

## すぐ使いたいならここ読んで！（アプリの起動方法、使い方）
zipファイルを展開し、中のMusicManager.exeを実行します。ブラウザが立ち上がります。
「曲を追加」ではMusicManagerに曲を登録します。曲名、アーティスト、アルバムなどが設定できます。情報を入力して楽曲ファイルをアップロードしたら、「ライブラリに追加」をクリックします。
ここで追加した楽曲は「データベースを管理」の画面に表示されます。セルをダブルクリックして編集できます。試聴もできます。削除もここで可能です。
音楽をプレイリストに登録して楽しむには「音楽を再生」をクリックします。
画面を開くと既存のプレイリストが読み込まれますが、初期状態では何も登録されていません。
「プレイリスト」という文字の下の何もない個所を右クリックすると、「プレイリストを新規作成」という項目が表示されます。これをクリックしてプレイリストを作成します。
プレイリストに曲を追加するには左の追加したいプレイリスト名を右クリックします。「曲を編集」をクリックします。
ここで登録されている楽曲一覧が表示されるのでプレイリストに追加したい楽曲にチェックを入れて右下の「設定」をクリックします。
タイトル、アーティスト、アルバムなどカラムをクリックすることでソートできたり様々な機能がこの画面にはあります。詳細は下部の全機能説明をご確認ください。
そしたらプレイリストをどれかクリックして右に表示された再生ボタンやシャッフルボタンを押してみましょう。プレイリストを再生できます。

## ファイル構成と起動まで
v1.0.0-beat1の場合、ダウンロードされたzipファイルをFreesoftなどのフォルダ内で展開します。
（7-zipをご利用の場合、「ここに展開」ではなく「展開」がおすすめです。Freesoftなどのフォルダ内で展開する理由については今後の利用方法をお読みいただければおわかりいただけます。）
展開するとappフォルダとMusicManager.exeがあります。appフォルダは絶対に削除しないでください。再ダウンロードする以外に復元する方法はございません。
また、appフォルダとMusicManager.exeのディレクトリ構造を変えないでください。（appフォルダとMusicManager.exeをまとめて移動する場合は構いません）
MusicManager.exeが本体になり、appフォルダはMusicManager.exeのUIを構成するものです。
MusicManager.exeを実行するとlibraryフォルダとuserfilesフォルダが生成されます。
libraryフォルダにはimagesフォルダ、musicフォルダが生成されます。
userfilesフォルダにはsettings.ini（アプリ内設定の保存）が生成されます。
基本的にlibraryフォルダやuserfilesフォルダには手を加えないことを推奨します。
appフォルダはhtml, css, jsが多数保存されておりますので、ご自身でデザイン変更などをすることも可能です。

## 全機能説明
「曲を追加」ではMusicManagerに曲を登録します。曲名、アーティスト、アルバム、ジャンル、トラックナンバー、アルバムアートが設定できます。情報を入力して楽曲ファイルをアップロードしたら、「ライブラリに追加」をクリックします。
「データベースを管理」では登録されたすべての楽曲が表示されます。ページ分けされています。初期状態では1ページあたり50曲表示されますが、これは設定で変更可能です。また、すべて表示をすることもできます。（500曲あたりを目安に重くなり始めます）
「エクスポート」では楽曲ファイル、アルバムアート、データベース、設定ファイル、プレイリスト・再生履歴を出力することができます。ファイル構成をそのまま引き継げるので互換性のあるバージョンの場合、エクスポートしたzipファイルを展開して、中野フォルダやファイルをすべてMusicManager.exeと同階層に設置することで、引き継ぐことができます。そのままのファイルで引き継げるかどうかやそのまま引き継げない場合の引き継ぎ対処法などはReleaseNoteをご確認ください。
また、エクスポート機能では保存先とファイル名を指定できます。エクスポート完了後、どこに保存されたのか再確認できます。ただし、この画面を閉じるとどこに保存したのかは二度と表示されません。
楽曲データは保存内容には著作権にも関わり、再生履歴や聞いている楽曲、プレイリストなどは個人情報の流出になりかねません。そのため、エクスポートにはパスワード保護をかけることができまあす。パスワード保護をかけると、エクスポートされたzipファイルがパスワード付きzipになります。
ただし、エクスポート機能で楽曲の項目を有効にすると楽曲ファイル数が多い場合、エクスポートにかなり自時間がかかります。予めご了承ください。
「インポート」では既定の形式で書かれた楽曲一覧のjsonファイルを読み込むことで楽曲のコピー、アルバムアートのコピー、mp3tag設定、データベースへの登録をすべて自動で行います。すでにほかの楽曲管理アプリをご利用の場合はこちらの方が便利かもしれません。jsonファイルの形式は言語別説明の最後の言語の下（Readmeの一番最後）をご確認ください。（import.json）
※v1.0.0-beta1ではcsv形式のインポートには対応していません。ご了承ください。

## 内部システム
pythonのeelライブラリとウェブUIの制限上、tkinterを利用しないとファイルパスを参照ということができず、仮にファイルパスを参照できたとしてJSで楽曲を再生できないので楽曲をコピーしています。
ファイルをライブラリに追加した時点で楽曲ファイルはlibrary/musicに<ランダムな文字列>.mp3で保存されます。保存の際にmp3tagも設定されます。また、既存のmp3tagは削除されます。
アルバムアートも追加した場合、画像ファイルはlibrary/imagesに<ランダムな文字列>.pngで保存されます。（もしかしたらjpgでも保存される可能性があります。pngでないとエラー発生の可能性あり）
アルバムアートのランダムな文字列と楽曲ファイルのランダムな文字列は同じものです。
データベース管理から楽曲データを削除すると、論理削除ではなく事実削除となり、library/musicやlibrary/imagesから関連付けられたファイルは削除されます。
また、userfiles/music.jsonからも結びつけが解除されます。
userfiles/music.jsonは楽曲を追加するごとにランダムな文字列のファイル名と楽曲名、アーティストなどの楽曲情報などを結び付ける機能があり、このファイルが削除されたり、楽曲の結びつけが解除されると、データベース管理画面に表示されなくなります。
逆に楽曲ファイルを削除したり、アルバムアートを削除してmusic.jsonを残すと、再生時にエラーが発生します。タイトル、アーティストの編集でもmp3tagを書き込むのでそのタイミングにもエラーが発生します。
プレイリスト一覧はuserfiles/playlist.jsonにて管理しています。楽曲ファイルパス（相対パス）とプレイリスト名、ソート基準などが保存されています。

## 今後の開発予定機能
歌詞機能
YouTube等動画プラットフォームからのダウンロード機能
スマートプレイリスト
多言語対応？
プレイリストの楽曲並び順変更
インポートのcsv対応

# Codes
import.json
``` json
[
    {
        "title": "MusicTitle1",
        "artist": "Artist1",
        "album": "album1",
        "track": "1",
        "genre": "genre1",
        "musicFilename": "C:/Full/path/to/your/music1.mp3",
        "imageFilename": "C:/Full/path/to/your/album/art1.png"
    },
    {
        "title": "MusicTitle2",
        "artist": "Artist2",
        "album": "album2",
        "track": "2",
        "genre": "genre2",
        "musicFilename": "C:/Full/path/to/your/music2.mp3",
        "imageFilename": "C:/Full/path/to/your/album/art2.png"
    },
]
```
